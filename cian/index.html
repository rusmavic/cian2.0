<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RealEstatePro - Недвижимость в России</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="header">
        <nav class="nav-container">
            <div class="logo">RealEstatePro</div>
            <div class="main-nav">
                <a href="#" class="nav-link active" data-filter="all">Все</a>
                <a href="#" class="nav-link" data-filter="sale">Купить</a>
                <a href="#" class="nav-link" data-filter="rent">Арендовать</a>
                <a href="register.html" class="nav-link">Регистрация</a>
            </div>
        </nav>
    </header>

    <main class="main-content">
        <!-- Блок фильтров -->
        <aside class="filters-sidebar">
            <div class="filter-group">
                <h3 class="filter-title">Тип недвижимости</h3>
                <label class="filter-option">
                    <input type="checkbox" value="apartment" class="type-filter"> Квартира
                </label>
                <label class="filter-option">
                    <input type="checkbox" value="house" class="type-filter"> Дом
                </label>
                <label class="filter-option">
                    <input type="checkbox" value="commercial" class="type-filter"> Коммерческая
                </label>
            </div>

            <div class="filter-group">
                <h3 class="filter-title">Цена, ₽</h3>
                <div class="price-range">
                    <input type="number" id="min-price" placeholder="От">
                    <input type="number" id="max-price" placeholder="До">
                </div>
            </div>

            <div class="filter-group">
                <h3 class="filter-title">Количество комнат</h3>
                <div class="rooms-filter">
                    <button class="room-btn" data-rooms="1">1</button>
                    <button class="room-btn" data-rooms="2">2</button>
                    <button class="room-btn" data-rooms="3">3</button>
                    <button class="room-btn" data-rooms="4">4</button>
                </div>
            </div>
        </aside>

        <!-- Список объектов -->
        <div class="listings-container">
            <!-- Карточки для продажи -->
            <div class="listing-card" data-type="sale" data-category="apartment" data-rooms="4" data-price="366800000">
                <img src="крас2405684085-1.jpg" class="listing-image" alt="Квартира">
                <div class="listing-info">
                    <div class="price">366 800 000 ₽</div>
                    <h3>4-комн. квартира, 154 м²</h3>
                    <p>Москва, ЦАО, м. Павелецкая</p>
                    <div class="details">
                        <span><i class="fas fa-bed"></i> 4 комнаты</span>
                        <span><i class="fas fa-expand"></i> 154 м²</span>
                        <span><i class="fas fa-layer-group"></i> 5/5 этаж</span>
                    </div>
                    <a href="product1.html" class="details-btn">Подробнее</a>
                </div>
            </div>

            <div class="listing-card" data-type="sale" data-category="house" data-rooms="4" data-price="12000000">
                <img src="2412173721-1.jpg" class="listing-image" alt="Дом">
                <div class="listing-info">
                    <div class="price">12 000 000 ₽</div>
                    <h3>4-комн. дом, 120 м²</h3>
                    <p>Московская область, г. Химки</p>
                    <div class="details">
                        <span><i class="fas fa-bed"></i> 4 комнаты</span>
                        <span><i class="fas fa-expand"></i> 120 м²</span>
                        <span><i class="fas fa-home"></i> Дом</span>
                    </div>
                    <a href="product2.html" class="details-btn">Подробнее</a>
                </div>
            </div>

            <!-- Карточки для аренды -->
            <div class="listing-card" data-type="rent" data-category="apartment" data-rooms="2" data-price="30000">
                <img src="2132194593-1.jpg" class="listing-image" alt="Студия">
                <div class="listing-info">
                    <div class="price">30 000 ₽/мес</div>
                    <h3>2-комн. квартира, 35 м²</h3>
                    <p>Московская область, г.деревня Кузнецово, </p>
                    <div class="details">
                        <span><i class="fas fa-bed"></i> 2 комнаты</span>
                        <span><i class="fas fa-expand"></i> 35 м²</span>
                        <span><i class="fas fa-layer-group"></i> 3/5 этаж</span>
                    </div>
                    <a href="product3.html" class="details-btn">Подробнее</a>
                </div>
            </div>

            <div class="listing-card" data-type="rent" data-category="commercial" data-rooms="0" data-price="50000">
                <img src="voxhall-moskva-jk-1449332468-6.jpg" class="listing-image" alt="Офис">
                <div class="listing-info">
                    <div class="price">150 000 ₽/мес</div>
                    <h3>Офис, 60 м²</h3>
                    <p>Москва, ЦАО, р-н Якиманка, Берсеневская наб., 6С5</p>
                    <div class="details">
                        <span><i class="fas fa-building"></i> Коммерческая</span>
                        <span><i class="fas fa-expand"></i> 60 м²</span>
                        <span><i class="fas fa-layer-group"></i> 2 этаж</span>
                    </div>
                    <a href="product4.html" class="details-btn">Подробнее</a>
                </div>
            </div>
        </div>

        <div class="listings-container">
            <!-- Карточки для продажи -->
            <div class="listing-card" data-type="sale" data-category="apartment" data-rooms="3" data-price="155800000">
                <img src="art2407391205-1.jpg" class="listing-image" alt="Квартира">
                <div class="listing-info">
                    <div class="price">155 800 000 ₽</div>
                    <h3>3-комн. квартира, 124 м²</h3>
                    <p>Москва, ЦАО, м. Павелецкая</p>
                    <div class="details">
                        <span><i class="fas fa-bed"></i> 3+ комнаты</span>
                        <span><i class="fas fa-expand"></i> 124 м²</span>
                        <span><i class="fas fa-layer-group"></i> 3/5 этаж</span>
                    </div>
                    <a href="product5.html" class="details-btn">Подробнее</a>
                </div>
            </div>

            <div class="listing-card" data-type="sale" data-category="house" data-rooms="4" data-price="12000000">
                <img src="dom2226122363-1.jpg" class="listing-image" alt="Дом">
                <div class="listing-info">
                    <div class="price">290 000 000 ₽</div>
                    <h3>4-комн. дом, 120 м²</h3>
                    <p>Московская область, г.деревня Кузнецово, район Бекасово</p>
                    <div class="details">
                        <span><i class="fas fa-bed"></i> 4 комнаты</span>
                        <span><i class="fas fa-expand"></i> 120 м²</span>
                        <span><i class="fas fa-home"></i> Дом</span>
                    </div>
                    <a href="product6.html" class="details-btn">Подробнее</a>
                </div>
            </div>

            <!-- Карточки для аренды -->
            <div class="listing-card" data-type="rent" data-category="apartment" data-rooms="2" data-price="500000">
                <img src="klubnyy-dom-turgenev-moskva-jk-2324761793-6.jpg" class="listing-image" alt="Студия">
                <div class="listing-info">
                    <div class="price">500 000 ₽/мес</div>
                    <h3>2-комн. квартира, 75 м²</h3>
                    <p>Москва, ЦАО, р-н Тверской, Георгиевский пер., 1</p>
                    <div class="details">
                        <span><i class="fas fa-bed"></i> 2 комнаты</span>
                        <span><i class="fas fa-expand"></i> 75 м²</span>
                        <span><i class="fas fa-layer-group"></i> 3/5 этаж</span>
                    </div>
                    <a href="product7.html" class="details-btn">Подробнее</a>
                </div>
            </div>

            <div class="listing-card" data-type="rent" data-category="commercial" data-rooms="0" data-price="50000">
                <img src="2392364556-4.jpg" class="listing-image" alt="Офис">
                <div class="listing-info">
                    <div class="price">50 000 ₽/мес</div>
                    <h3>Офис, 60 м²</h3>
                    <p>Москва, ЦАО, м. Тверская</p>
                    <div class="details">
                        <span><i class="fas fa-building"></i> Коммерческая</span>
                        <span><i class="fas fa-expand"></i> 60 м²</span>
                        <span><i class="fas fa-layer-group"></i> 2 этаж</span>
                    </div>
                    <a href="product8.html" class="details-btn">Подробнее</a>
                </div>
            </div>
        </div>
    </main>

    <!-- Карта -->
    <div id="map-container" style="width: 100%; height: 500px;"></div>

    <!-- Модальное окно -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <img id="modal-image" src="" alt="Изображение объекта" class="modal-image">
            <div class="modal-info">
                <h2 id="modal-title"></h2>
                <p id="modal-location"></p>
                <div class="modal-details">
                    <span id="modal-rooms"></span>
                    <span id="modal-area"></span>
                    <span id="modal-floor"></span>
                </div>
                <div class="modal-price" id="modal-price"></div>
            </div>
        </div>
    </div>

    <script>
        // Фильтрация карточек
        const filterLinks = document.querySelectorAll('.nav-link');
        const listingCards = document.querySelectorAll('.listing-card');
        const typeFilters = document.querySelectorAll('.type-filter');
        const minPriceInput = document.getElementById('min-price');
        const maxPriceInput = document.getElementById('max-price');
        const roomButtons = document.querySelectorAll('.room-btn');

        // Данные объектов с координатами
        const listingsData = [
            {
                type: 'sale',
                category: 'apartment',
                rooms: '4',
                price: 366800000,
                coords: [55.730623, 37.636925], // Координаты для Москвы, м. Павелецкая
            },
            {
                type: 'sale',
                category: 'house',
                rooms: '4',
                price: 12000000,
                coords: [55.888642, 37.433048], // Координаты для Химок
            },
            {
                type: 'rent',
                category: 'apartment',
                rooms: '1',
                price: 30000,
                coords: [59.941871, 30.298481], // Координаты для Санкт-Петербурга, м. Василеостровская
            },
            {
                type: 'rent',
                category: 'commercial',
                rooms: '0',
                price: 50000,
                coords: [55.760241, 37.608422], // Координаты для Москвы, м. Тверская
            },
            {
                type: 'sale',
                category: 'apartment',
                rooms: '2', 
                price: 5800000,
                coords: [55.741667, 37.606568], // Координаты для Москвы, красный октябрь
            },
            {
                type: 'sale',
                category: 'house',
                rooms: '4',
                price: 12000000,
                coords: [55.888642, 37.433048], // Координаты для Химок
            },
            {
                type: 'rent',
                category: 'apartment',
                rooms: '2',
                price: 5000000,
                coords: [55.759451, 37.613934], // Координаты для Санкт-Петербурга, м. Василеостровская
            },
            {
                type: 'rent',
                category: 'commercial',
                rooms: '0',
                price: 50000,
                coords: [55.727220, 37.643525], // Координаты для Москвы, м. Тверская
            },
        ];

        // Инициализация карты
        let map = null;
        let objectMarkers = [];

        function initMap() {
            ymaps.ready(() => {
                map = new ymaps.Map('map-container', {
                    center: [55.751244, 37.618423], // Центр карты (Москва)
                    zoom: 10,
                    controls: ['zoomControl'],
                });

                updateMapMarkers();
            });
        }

        // Обновление меток на карте
        function updateMapMarkers() {
            // Удаляем старые метки
            objectMarkers.forEach(marker => map.geoObjects.remove(marker));
            objectMarkers = [];

            // Добавляем новые метки
            listingCards.forEach((card, index) => {
                if (card.style.display !== 'none') {
                    const data = listingsData[index];
                    if (data) {
                        const marker = new ymaps.Placemark(
                            data.coords,
                            { balloonContent: card.querySelector('h3').innerText },
                            { preset: 'islands#blueHomeIcon' }
                        );
                        objectMarkers.push(marker);
                        map.geoObjects.add(marker);
                    }
                }
            });
        }

        // Функция для фильтрации
        function filterListings() {
            const selectedType = document.querySelector('.nav-link.active').dataset.filter;
            const selectedCategories = Array.from(typeFilters)
                .filter(filter => filter.checked)
                .map(filter => filter.value);
            const minPrice = parseFloat(minPriceInput.value) || 0;
            const maxPrice = parseFloat(maxPriceInput.value) || Infinity;
            const selectedRooms = Array.from(roomButtons)
                .filter(button => button.classList.contains('active'))
                .map(button => button.dataset.rooms);

            listingCards.forEach(card => {
                const cardType = card.dataset.type;
                const cardCategory = card.dataset.category;
                const cardRooms = card.dataset.rooms;
                const cardPrice = parseFloat(card.dataset.price);

                const typeMatch = selectedType === 'all' || cardType === selectedType;
                const categoryMatch = selectedCategories.length === 0 || selectedCategories.includes(cardCategory);
                const priceMatch = cardPrice >= minPrice && cardPrice <= maxPrice;
                const roomsMatch = selectedRooms.length === 0 || selectedRooms.includes(cardRooms);

                if (typeMatch && categoryMatch && priceMatch && roomsMatch) {
                    card.style.display = 'flex';
                } else {
                    card.style.display = 'none';
                }
            });

            updateMapMarkers();
        }

        // Обработчики событий
        filterLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                filterLinks.forEach(link => link.classList.remove('active'));
                link.classList.add('active');
                filterListings();
            });
        });

        typeFilters.forEach(filter => {
            filter.addEventListener('change', filterListings);
        });

        minPriceInput.addEventListener('input', filterListings);
        maxPriceInput.addEventListener('input', filterListings);

        roomButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                e.preventDefault();
                button.classList.toggle('active');
                filterListings();
            });
        });

        // Модальное окно
        const modal = document.getElementById('modal');
        const modalImage = document.getElementById('modal-image');
        const modalTitle = document.getElementById('modal-title');
        const modalLocation = document.getElementById('modal-location');
        const modalRooms = document.getElementById('modal-rooms');
        const modalArea = document.getElementById('modal-area');
        const modalFloor = document.getElementById('modal-floor');
        const modalPrice = document.getElementById('modal-price');
        const closeModal = document.querySelector('.close');

        // Обработчик клика на карточку
        listingCards.forEach(card => {
            card.addEventListener('click', () => {
                const image = card.querySelector('.listing-image').src;
                const title = card.querySelector('h3').innerText;
                const location = card.querySelector('p').innerText;
                const details = card.querySelectorAll('.details span');
                const price = card.querySelector('.price').innerText;

                // Заполняем модальное окно данными
                modalImage.src = image;
                modalTitle.innerText = title;
                modalLocation.innerText = location;
                modalRooms.innerText = details[0].innerText;
                modalArea.innerText = details[1].innerText;
                modalFloor.innerText = details[2].innerText;
                modalPrice.innerText = price;

                // Показываем модальное окно
                modal.style.display = 'flex';
            });
        });

        // Закрытие модального окна
        closeModal.addEventListener('click', () => {
            modal.style.display = 'none';
        });

        // Закрытие модального окна при клике вне его
        window.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });

        // Загрузка API Яндекс.Карт с вашим ключом
        const script = document.createElement('script');
        script.src = 'https://api-maps.yandex.ru/2.1/?apikey=c9c499c8-22a5-48de-a29f-9805b9a83779&lang=ru_RU';
        document.head.appendChild(script);
        script.onload = () => initMap();
    </script>
</body>
</html>